# 패턴3: 작은 인터페이스

지금까지의 과정을 통해 함수 대부분이 <mark style="background-color:green;">한 줄짜리 코드</mark>가 되었습니다.



줄 수보다 중요한 것은 코드가 <mark style="background-color:green;">적절한 구체화 수준</mark>과 <mark style="background-color:green;">일반화</mark>가 되었는지입니다.

일반적으로 한 줄짜리 코드는 여러 구체화 수준이 섞일 일이 없기 때문에 좋은 코드라는 표시입니다.



### 패턴3: 작은 인터페이스

작은 인터페이스 패턴은 새로운 코드를 <mark style="background-color:green;">추가할 위치</mark>에 관한 것입니다.



### 인터페이스 역할의 코드 위치 두가지 방법



1. 추상화 벽에 만들기

추상화 벽 계층에 있으면 해시 맵 데이터 구조로 되어 있는 장바구니에 접근할 수 있습니다. 하지만 같은 계층에 있는 함수를 사용할 수 없습니다.



2. 추상화 벽 위에 만들기

추상화 벽 위에 만들면 해시 데이터 구조를 직접 접근할 수 없습니다. 추상화 벽에 있는 함수를 사용해서 장바구니에 접근해야 합니다.



### 추상화 벽 <mark style="background-color:green;">위에</mark> 있는 계층에 구현하는 것이 더 좋습니다.

* 더 '직접 구현'에 가깝습니다.
* 추상화 벽에 만들기의 단점
  * 시스템 하위 계층 코드가 늘어나기 때문에 좋지 않습니다.
  * 시스템 하위 계층 코드들은 개발팀이 직접 관리해야합니다.
  * 새로운 함수가 생길수록 '새로운 계약'이 늘어나는 것과 같습니다.

그러므로 가능한 <mark style="background-color:green;">'상위 계층'</mark>에 코드를 위치하는게 작은 인터페이스 패턴이라고 할 수 있습니다.



### 코드 위치에 대한 설계 결정

추가하려는 코드는 logAddToCart() 함수로 db에 로그 데이터를 남기는 것입니다.

그리고 가장 쉬운 방법은 add\_item() 함수 안에 넣는 것입니다.



그러나 해당 함수는 액션으로 이 코드를 잘 설계한 '계산'에 무지성으로 추가할 경우 이 액션의 전염병이 모든 코드에 퍼지게 됩니다.&#x20;

그러므로 <mark style="background-color:green;">'액션', '계산' 구분을 하는 설계적인 관점을 꼭 고려</mark>해야합니다.



또한, update\_shipping\_icons() 함수는 내부적으로 logAddToCart 함수를 사용하고 있는데 유기적으로 이 함수는 logAddToCart 함수를 포함해버리게 됩니다. 이는 아이템을 추가한 것이 아니기 때문에 로그를 남기면 안되기 때문에 버그를 발생시킵니다.



그러므로 장바구니에 관한 인터페이스를 <mark style="background-color:green;">'깔끔하게' 유지</mark>해야 합니다.



고로 logAddToCart 함수는 추상화 벽 위에 있는 계층에서 호출하는 것이 좋습니다.



### 더 좋은 위치는?

1. 해당 함수는 '액션(전염병)'이다.
2. 추상화 벽 '위에' 있어야 한다.

일단 모든 상황에 맞는 설계는 없다는 것을 기억해야합니다.&#x20;



그래서 찾은 곳은 add\_item\_to\_cart() 함수입니다.

이 함수는 이미 액션이며 제품을 담을 때 호출하는 핸들러 함수입니다. 고로 이미 제품을 장바구니에 담을 때 해야 할 모든 일들을 담은 함수의 의미를 가지고 있습니다.



이 방법이 유일한 정답은 아닙니다. 그러므로 우리는 토론과 지속적인 고민을 해봐야합니다.



### 결론

작은 인터페이스 패턴을 사용하면 깨끗하고 단순하고 믿을 수 있는 인터페이스에 집중할 수 있습니다. 그리고 감춰진 코드의 나머지 부분을 대신하는 코드를 사용할 수 있습니다. 또 인터페이스가 많아져서 생기는 불필요한 변경이나 확장을 막아줍니다.



이 패턴은 '추상화 벽'을   기준으로서 상당히 중요한 의미를 갖지만 모든 계층에 통용되는 패턴입니다. 항상 완벽하게 할 수는 없지만 이 목표에 가려고 하는 노력이 중요합니다.





