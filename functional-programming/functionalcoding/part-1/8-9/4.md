# 패턴4: 편리한 계층

추상화를 만드는 것은 어려운 일입니다.&#x20;

쉬운 예시로 자바스크립트는 <mark style="background-color:blue;">기계어에 대한 추상화 벽</mark>을 제공합니다.

자바스크립트로 코딩을 할 때 <mark style="background-color:blue;">기계어를 생각</mark>하는 사람은 아무도 없습니다.

이것은 <mark style="background-color:blue;">수십 년에 걸쳐 수천 명</mark>의 사람들이 강력한 파서와 컴파일러 그리고 가상 머신을 만들었습니다.



편리한 계층 패턴은ㅇ 언제 패턴을 적용하고 또 언제 멈춰야 하는지 실용적인 방법을 알려줍니다.



스스로 물어봅시다.

<mark style="background-color:blue;">지금 작업하는 코드가 편리한가요 ?</mark>

그렇다면 설계는 조금 멈춰도 됩니다. 패턴에 집착하지말고 그대로 두세요.



그렇지 않나요 ? 구체적으로 너무 많은 것을 알아야하거나 코드가 지저분하다고 느끼나요 ???

그렇다면 다시 패턴을 적용하세요.

어떤 코드도 이상적인 모습에 도달할 수는 없지만 설계와 새로운 기능의 필요성 사이 어느 지점에 머물게 됩니다. 그 지점이 만족스럽지 않다면 계속 도전하세요.





### '호출 그래프'로 알 수 있는 코드에 대한 정보는 무엇이 있을까요 ??

<figure><img src="../../../.gitbook/assets/image (13).png" alt=""><figcaption></figcaption></figure>

호출 그래프에서 함수 이름을 없애면 <mark style="background-color:blue;">구조에 대한 추상적인 모습</mark>을 볼 수 있습니다.



* 기능적 요구사항 : 소프트웨어가 정확히 해야 하는 일(비즈니스 로직 등)
*   비기능적 요구사항&#x20;

    1.유지보수성(maintainability): 요구 사항이 바뀌었을 때 가장 쉽게 고칠 수 있는 코드는 어떤 코드인가요?

    2.테스트성(testability) : 어떤 것을 테스트하는 것이 가장 중요한가요?

    3.재사용성(reusability) : 어떤 함수가 재사용하기 좋나요?

호출 그래프에 함수 이름을 빼고 보면, 코드 위치를 통해 세 가지 중요한 비기능적 요구사항에 답할 수 있습니다.



### 그래프의 가장 위에 있는 코드가 고치기 가장 쉽습니다.

가장 위에 있는 코드는 어디에서도 호출하지 않기 때문에 고치기 쉽습니다.

다른 코드에 영향을 주지 않고 변경할 수 있습니다.



### 아래에 있는 코드는 테스트가 중요합니다.

모든 코드를 테스트하는 것은 비현실적입니다.&#x20;

가장 위에 있는 함수를 테스트하면 많은 코드를 확인할 수 있습니다.&#x20;

\=> 유기적으로 연관되어 있는 아래의 계층 코드들도 테스트하는 셈이기 때문에

그러나 아래에 있는 함수일수록 많은 상위  계층의코드들이 의존하고 있습니다. 그래서 아래에 있는 코드의 테스트가 중요할 수도 있습니다.



* 제대로 만들었다면 위에 있는 코드일수록 바뀔 가능성이 높습니다. 그러므로 테스트 코드 역시 변경될 가능성이 높습니다.&#x20;
* 아래에 있을수록 재사용하기 더 좋습니다. 그러므로 테스트 코드 역시 재사용이 됩니다.

<figure><img src="../../../.gitbook/assets/image (9).png" alt=""><figcaption></figcaption></figure>

### 요약

* 유지보수성&#x20;
  * 규칙:위로 연결된 것이 적은 함수가 바꾸기 쉽습니다.
  * 핵심:자주 바뀌는 코드는 가능한 위쪽에 있어야 합니다.
* 테스트 가능성
  * 규칙:위쪽으로 많이 연결된 함수를 테스트하는 것이 더 가치있습니다.
  * 핵심:아래쪽에 있는 함수를 테스트하는 것이 위쪽에 있는 함수를 테스트하는 것보다 가치 있습니다.
* 재사용성&#x20;
  * 규칙:아래쪽에 함수가 적을수록 더 재사용할 수 있습니다.
  * 핵심:낮은 수준의 단계로 함수를 빼내면 재사용성이 더 높아집니다.



### 결론

이러한 패턴들을 익혀 비즈니스 요구를 해결하기 충분히 편리한 코드인지 아닌지는 직관을 따라야 합니다. 우리는 훈련을 하는 것입니다.



